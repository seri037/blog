---
title: "GSoC '24 进度更新：第 7 & 8 周"
summary: "第 7-8 周进展：改进了多层字幕轨道功能，新增了图层指示器和管理器支持，并实现了 SRT 到 ASS 的自动转换。目前正为接下来的样式管理工作做准备。"
categories: Development
tags:
    - KDE
    - GSoC
    - Kdenlive
date: 2024-07-24 20:00:00 +0800
translated: true
---

### 多层字幕轨道

我继续完善了上一篇博客中提到的多层字幕功能。现在，用户可以直接在时间轴上添加新图层：只需将现有字幕块拖出当前字幕轨道的底部边缘即可。字幕的添加、移动和删除操作与以往保持一致，并已全面支持图层特性。

此外，我还为字幕轨道头部添加了一个图层指示器，效果如下：

![](https://github.com/seri037/blog/blob/main/static/img/layer_indicator.png?raw=true)

除了可以为特定的字幕事件设置样式外，我还计划增加为不同字幕层设置默认样式的功能。这将让用户能够更便捷地为同一层内的字幕组应用统一的视觉风格。

### 改进的字幕管理器

图层管理功能现已集成到字幕管理器中，其界面也经过了重新设计，焕然一新：

![](https://github.com/seri037/blog/blob/main/static/img/subtitle_manager.png?raw=true)

现在，图层也支持“重复”和“删除”等快捷操作了。

### 自动转换 .srt 字幕

为了更好地测试和开发样式功能，我将字幕的存储格式切换为了 .ass。在导师的帮助下，我们现在可以自动将旧项目中的 .srt 文件转换为 .ass 格式，同时保留原始的 .srt 文件作为备份。

![](https://github.com/seri037/blog/blob/main/static/img/subtitle_conversion.png?raw=true)

目前在样式转换方面仍有一些细节问题（例如字体大小偶有偏差）。不过，我认为现在是时候将重心转向“样式编辑小部件（Styling Widget）”的开发了，Bug 的修复可以稍后再做。接下来的两周我将全力投入样式管理功能的实现，这也是本项目最核心的部分，敬请期待！
