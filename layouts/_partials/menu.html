<nav class="main-menu{{ if not ($.Param "menuinheader") }} mx--xs layout__navigation{{ end }}" aria-label="{{ i18n "menu_title" }}">
<ul class="flex-inline mx--0">
{{ $currentPage := . -}}
{{ $catTerm := "" -}}
{{ $tagTerm := "" -}}
{{ if eq $currentPage.Kind "term" -}}
  {{ $singular := lower $currentPage.Data.Singular -}}
  {{ if eq $singular "category" -}}
    {{ $catTerm = $currentPage.Title -}}
  {{ end -}}
  {{ if eq $singular "tag" -}}
    {{ $tagTerm = $currentPage.Title -}}
  {{ end -}}
{{ end -}}
{{ range site.Menus.main -}}
  {{ $isCategories := or (eq (lower .Identifier) "categories") (eq (lower .Name) "categories") -}}
  {{ $isTags := or (eq (lower .Identifier) "tags") (eq (lower .Name) "tags") -}}
  {{ $showCat := and $isCategories $catTerm -}}
  {{ $showTag := and $isTags $tagTerm -}}
  {{ $isActive := or ($currentPage.IsMenuCurrent "main" .) ($currentPage.HasMenuCurrent "main" .) $showCat $showTag -}}
  {{ $label := or (i18n .Identifier) .Name -}}
  {{ $labelPlain := $label | plainify -}}
  <li>
     <a href="{{ .URL | relLangURL }}" class="main-menu__link{{ if $isActive }} is-term-active{{ end }}" aria-label="{{ $labelPlain }}" title="{{ $labelPlain }}"{{ if $isActive }} aria-current="page"{{ end }}>
      {{ with .Pre }}{{ . }}{{ end }}<span class="main-menu__label{{ if .Pre }} visually-hidden{{ end }}">{{ $label | safeHTML }}</span>{{ with .Post }}{{ . }}{{ end }}
    </a>
  </li>
{{ end -}}
</ul>
</nav>
