@mixin theme-dark-vars {
  /* Material Design 3 - Purple (Dark) */
  --color-text: #e6e1e5;
  --color-text-bg: #1c1b1f;
  --color-text-meta: #cac4d0;
  --color-headings: #d0bcff;
  --color-code: #e6e1e5;

  --color-link: #eaddff;
  --color-link-visited: #eaddff;
  --color-link-hover: #ffb74d;
  --color-link-active: #ffb74d;

  --color-button: #2b2730;
  --color-button-hover: #3a3242;
  --color-button-text: #eaddff;
  --color-button-text-hover: #ffffff;

  --color-border: #d0bcff;
  --color-border-light: #6d5a8a;
  --color-border-dark: #625b71;

  --color-header-bg: #1c1b1f;
  --color-footer-bg: #1c1b1f;
  --color-body-bg: #1c1b1f;
  --color-backdrop: #121015;
}

:root {
  /* Material Design 3 - Purple (Light) */
  --color-orange: #ffb300;
  --color-orange-light: #ffe082;
  --color-orange-dark: #ff8f00;
  --color-orange-alt: #ff6f00;

  --color-purple: #6750a4;
  --color-purple-light: #eaddff;
  --color-purple-dark: #4f378b;
  --color-purple-alt: #7f67be;

  --color-brand: #6750a4; /* primary */
  --color-brand-alt: #625b71; /* secondary */
  --color-brand-light: #eaddff; /* primary container */
  --color-brand-dark: #4f378b; /* primary dark */

  --color-text: #1c1b1f;
  --color-text-bg: #fffbfe;
  --color-text-meta: #49454f;
  --color-headings: #4f378b;
  --color-code: #1c1b1f;

  --color-link: #7f67be;
  --color-link-visited: #7f67be;
  --color-link-hover: #ff8f00;
  --color-link-active: #ff8f00;

  --color-button: #f5f2f8;
  --color-button-hover: #ede7f6;
  --color-button-text: #2b2730;
  --color-button-text-hover: #1c1b1f;

  --color-border: #4f378b;
  --color-border-light: #b8a7d9;
  --color-border-dark: #625b71;

  --color-header-bg: #fffbfe;
  --color-footer-bg: #fffbfe;
  --color-body-bg: #fffbfe;
  --color-backdrop: #f3edf7;
}

/* Theme transition */
html,
body,
.page,
.header,
.footer,
.tools-toolbar__btn,
.tools-toolbar__tooltip,
.main-menu__icon::after,
.main-menu__label::after,
.site-effect,
input[type='search'][data-search-text],
a {
  transition: all 220ms ease;
}

/* Background effect layer */
.site-effect {
  position: fixed;
  inset: 0;
  z-index: 0;
  opacity: 0.5;
  will-change: opacity;
  pointer-events: none;
}

:root[data-effect='off'] .site-effect {
  opacity: 0;
  visibility: hidden;
  transition: opacity 300ms ease, visibility 0s linear 300ms;
}

/* Hide effect and toggle when background is covered */
:root[data-effect-covered='true'] .site-effect {
  display: none !important;
}

:root[data-effect-covered='true'] [data-effect-toggle] {
  display: none !important;
}

.site-effect canvas {
  width: 100%;
  height: 100%;
  display: block;
}

.layout__page {
  position: relative;
  z-index: 1;
  min-height: 100vh;
}

.header__region {
  // center
  margin-left: auto;
  margin-right: auto;
}

.header {
  // height
  height: 100px;
}


.main-menu {
  a {
    text-align: center;
    background: transparent;
    color: var(--color-text);
    font-weight: var(--fw-medium);
    font-size: medium;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;

    &:hover,
    &:focus {
      background-color: transparent;
      color: var(--color-link-hover);
      .main-menu__label,
      .main-menu__icon {
        &::after {
          background: var(--color-link-hover);
        }
      }
    }

    &:active,
    &[aria-current] {
      background-color: transparent;
      color: var(--color-link-active);
      text-decoration: none;
      .main-menu__label,
      .main-menu__icon {
        &::after {
          background: var(--color-link-active);
        }
      }
    }

    &.is-term-active {
      .main-menu__label,
      .main-menu__icon {
        &::after {
          background: var(--color-link-active);
        }
      }
    }
  }

  .main-menu__label,
  .main-menu__icon {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding-bottom: 0.3rem;
  }

  .main-menu__label::after,
  .main-menu__icon::after {
    content: "";
    position: absolute;
    left: 50%;
    bottom: 0;
    height: 2px;
    background: var(--color-header-bg);
    transform: translateX(-50%);
  }

  .main-menu__label::after {
    width: calc(100% - 0.5rem);
  }

  .main-menu__icon::after {
    width: 1.25rem;
  }

  .main-menu__icon {
    font-family: "Material Symbols Sharp";
    font-weight: normal;
    font-style: normal;
    font-size: 22px;
    line-height: 1;
    font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
  }
}

.header__language-selector { // stylelint-disable selector-class-pattern
  display: none;

  @include respond-to(s) {
    display: block;
  }
} // stylelint-enable selector-class-pattern

.language-selector a {
  font-family: var(--ff-monospace);
}

/* Search input styling */
input[type='search'][data-search-text] {
  width: 100%;
  max-width: 28rem;
  padding: 0.45rem 0.75rem;
  border: 1px solid var(--color-border-light);
  border-radius: 0;
  background: var(--color-text-bg);
  color: var(--color-text);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
}

input[type='search'][data-search-text]::placeholder {
  color: var(--color-text-meta);
}

input[type='search'][data-search-text]:focus {
  outline: none;
  border-color: var(--color-border);
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--color-border) 35%, transparent);
}

.mobile-nav {
  --mobile-nav-button-size: 48px;
  --mobile-nav-stack-gap: 0.5rem;
  --mobile-nav-sheet-top: calc(var(--gutters) + env(safe-area-inset-top, 0px) + var(--mobile-nav-button-size) + var(--mobile-nav-stack-gap));
  --mobile-nav-item-border: var(--color-border-light);
  --mobile-nav-item-bg: var(--color-text-bg);
  --mobile-nav-item-bg-hover: var(--color-button-hover);

  &__cover {
    background: color-mix(in srgb, var(--color-backdrop) 65%, transparent);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    opacity: 0;
    pointer-events: none;

    [data-navopen] & {
      opacity: 1;
      pointer-events: auto;
    }
  }

  &__toggle {
    position: fixed;
    top: calc(var(--gutters) + env(safe-area-inset-top, 0px));
    right: calc(var(--gutters) + env(safe-area-inset-right, 0px));
    width: var(--mobile-nav-button-size);
    height: var(--mobile-nav-button-size);
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    z-index: 24;
    border: 1px solid var(--color-border-light) !important;
    border-radius: 0;
    background: var(--color-text-bg);
    background-image: none;
    color: var(--color-text);
    text-shadow: none;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15) !important;
    font-size: 0;
    transition: background-color 220ms ease, color 220ms ease, border-color 220ms ease, box-shadow 220ms ease !important;

    &:hover,
    &:focus-visible {
      background: var(--color-button-hover);
      color: var(--color-button-text-hover);
      border-color: var(--color-border-light) !important;
      outline: none;
    }

    [data-navopen] & {
      background: var(--color-button-hover);
    }

    svg {
      fill: var(--color-brand) !important;
      width: 22px;
      height: 22px;
      margin: 0;
      transition: fill 220ms ease !important;
    }
  }

  &__hamburger {
    margin-inline-start: 0;
  }

  &__hamburger > rect {
    transition: transform 220ms ease, y 220ms ease, opacity 220ms ease !important;
  }

  &__sheet {
    position: fixed !important;
    top: var(--mobile-nav-sheet-top) !important;
    right: calc(var(--gutters) + env(safe-area-inset-right, 0px)) !important;
    left: auto !important;
    width: var(--mobile-nav-button-size) !important;
    max-width: var(--mobile-nav-button-size) !important;
    height: auto !important;
    max-height: calc(100dvh - var(--mobile-nav-sheet-top) - (var(--gutters) + env(safe-area-inset-bottom, 0px))) !important;
    padding: 0 !important;
    border: 0 !important;
    background: transparent !important;
    box-shadow: none !important;
    overflow-y: auto !important;
    overscroll-behavior: contain !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
    transform: translateY(-8px) !important;
    transform-origin: top right !important;

    [data-navopen] & {
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: auto !important;
      transform: translateY(0) !important;
    }
  }

  &__navbar {
    display: flex;
    flex-direction: column;
    gap: var(--mobile-nav-stack-gap);
    padding: 0;
    margin: 0;

    li {
      list-style: none;
      margin: 0;
    }

    a {
      display: flex !important;
      align-items: center;
      justify-content: center;
      width: var(--mobile-nav-button-size);
      height: var(--mobile-nav-button-size);
      gap: 0;
      padding: 0;
      border: 1px solid var(--mobile-nav-item-border);
      border-radius: 0;
      background: var(--mobile-nav-item-bg);
      color: var(--color-text);
      line-height: 1;
      text-decoration: none;
      text-shadow: none;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);

      &:hover,
      &:focus-visible {
        background: var(--mobile-nav-item-bg-hover);
        color: var(--color-button-text-hover);
        text-decoration: none;
        border-color: var(--color-border-light);
      }

      &:focus-visible {
        outline: 2px solid color-mix(in srgb, var(--color-border) 45%, transparent);
        outline-offset: 2px;
      }

      &:active,
      &[aria-current='page'] {
        background: var(--mobile-nav-item-bg-hover);
        color: var(--color-link-active);
        border-color: var(--color-border);
      }
    }

    .main-menu__icon,
    .material-symbols-sharp {
      font-size: 23px;
      line-height: 1;
      color: currentColor;
    }

    .mobile-nav__lang-current {
      font-family: var(--ff-monospace);
      font-size: var(--fs-s);
      font-weight: var(--fw-bold);
      letter-spacing: 0.02em;
      text-transform: uppercase;
      line-height: 1;
    }
  }

  @media (prefers-reduced-motion: no-preference) {
    &__cover,
    &__sheet {
      transition: opacity 170ms ease, transform 170ms ease;
    }
  }

  &__toggle {
    @include respond-to(s) {
      display: none !important;
    }
  }

  @include respond-to(s) {
    display: none !important;
  }
}

.tools-toolbar {
  position: fixed;
  right: calc(var(--gutters) + env(safe-area-inset-right, 0px));
  bottom: calc(var(--gutters) + env(safe-area-inset-bottom, 0px));
  z-index: 9999;

  display: grid;
  gap: 0.5rem;
}

.tools-toolbar__btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;

  width: 48px;
  height: 48px;
  padding: 0;

  border: 1px solid var(--color-border-light);
  border-radius: 0;
  background: var(--color-text-bg);
  background-image: none;
  color: var(--color-text);
  text-decoration: none;
  text-shadow: none;
  line-height: 1;

  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
}

.tools-toolbar__btn:hover,
.tools-toolbar__btn:focus-visible {
  background: var(--color-button-hover);
  color: var(--color-button-text-hover);
  border-color: var(--color-border-light);
  outline: none;
}

.tools-toolbar__btn--static {
  position: relative;
  cursor: default;
}

.tools-toolbar__btn--static:active {
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
}

.tools-toolbar__tooltip {
  position: absolute;
  right: 100%;
  top: 50%;
  transform: translateY(-50%);
  margin-right: 0;

  min-width: 260px;
  min-height: 48px;
  height: 48px;
  padding: 0.2rem 0.75rem;
  border: 1px solid var(--color-border-light);
  border-radius: 0;
  background: var(--color-text-bg);
  color: var(--color-text);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  display: flex;
  align-items: center;
  font-size: var(--fs-xs);
  line-height: 1.5;
  white-space: normal;
  overflow: hidden;
  display: -webkit-box;
  line-clamp: 2;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;

  opacity: 0;
  visibility: hidden;
  pointer-events: auto;
  z-index: 10000;
  transition: opacity 220ms ease, visibility 0s linear 220ms;
}

.tools-toolbar__btn--static:hover .tools-toolbar__tooltip,
.tools-toolbar__btn--static:focus-visible .tools-toolbar__tooltip,
.tools-toolbar__tooltip:hover {
  opacity: 1;
  visibility: visible;
  transition-delay: 0s;
}

.tools-toolbar__icon {
  font-family: "Material Symbols Sharp";
  font-weight: normal;
  font-style: normal;
  display: block;
  font-size: 22px;
  line-height: 1;
  font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme='light']) {
    color-scheme: dark;
    @include theme-dark-vars;
  }

  :root:not([data-theme='light']) .mobile-nav__toggle svg {
    fill: var(--color-button-text) !important;
  }
}

:root[data-theme='dark'] {
  color-scheme: dark;
  @include theme-dark-vars;
}

:root[data-theme='dark'] .mobile-nav__toggle svg {
  fill: var(--color-button-text) !important;
}

.footer {
  border-top: 0;
  opacity: 0;
}

.footer:hover {
  opacity: 1;
}

.translated {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-style: italic;
  font-size: var(--fs-s);
  color: var(--color-text-meta);
  margin-top: 1.5rem;
  margin-bottom: 1.5rem;
  padding: 0.5rem 0.75rem;
  background-color: var(--color-button);
  border-left: 3px solid var(--color-brand);
  width: 100%;
  transition: background-color 220ms ease, border-color 220ms ease;

  .material-symbols-sharp {
    font-size: 1.25rem;
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    transition: none;
  }
}

/* Hide menu on mobile */
@include respond-to-max(s) {
  /* Hide desktop menu on mobile */
  .main-menu {
    display: none !important;
  }
}

/* Show desktop menu on desktop */
@include respond-to(s) {
  .main-menu {
    display: flex !important;
  }
}
